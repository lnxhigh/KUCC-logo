m <- list(
    cbind(
        c(-0.54, 1.68, 2.464, -0.54, -0.15, 0.00),
        c(-4.23, -2.765, -1.18, -4.23, -3.5, -2.845)
    ),
    cbind(
        c(-1.65, -1.44, -0.71, -0.3484, -0.135, 0.1109, 2.04, 2.68, 3.375, 3.415),
        c(3.14, 4.735, 4.91, 4.5, 4.367, 4.2795, 4.177, 5.102, 3.69, 3.043)
    ),
    cbind(
        c(-1.2382, -1.22, -0.898, -0.739, -0.636, -0.612, -0.12, -0.045, 0.0865),
        c(2.7693, 3.655, 4.213, 4.251, 4.209, 4.09, 3.9, 3.807, 3.8115)
    ),
    cbind(
        c(1.9675, 2.1176, 2.2045, 2.414, 2.44, 2.491, 2.67, 2.988, 2.9885),
        c(3.7256, 3.675, 3.77, 3.869, 4.02, 4.035, 3.956, 3.287, 2.893)
    )
)

clist <- list(
    list(c = c(0.9177, 1.3935), r = sqrt(8.98)),
    list(c = c(0.9177, 1.3935), r = sqrt(6.54)),
    list(c = c(-0.374, 0.28), r = sqrt(9.8)),
    list(c = c(1.037, 1.5), r = sqrt(9.85)),
    list(c = c(0.479, 1.73), r = sqrt(0.092)),
    list(c = c(0.479, 1.145), r = sqrt(0.092)),
    list(c = c(2.682, 1.73), r = sqrt(0.092)),
    list(c = c(2.682, 1.145), r = sqrt(0.092))
)

L <- function(p, t) {
    p1 <- p[1,]; p2 <- p[2,]
    cbind(
        (1-t)*p1[1] + t*p2[1],
        (1-t)*p1[2] + t*p2[2]
    )
}

Q <- function(p, t) {
    p1 <- p[1,]; p2 <- p[2,]; p3 <- p[3,]
    cbind(
        (1-t)^2*p1[1] + 2*t*(1-t)*p2[1] + t^2*p3[1],
        (1-t)^2*p1[2] + 2*t*(1-t)*p2[2] + t^2*p3[2]
    )
}

C <- function(p, t) {
    p1 <- p[1,]; p2 <- p[2,]; p3 <- p[3,]; p4 <- p[4,]
    cbind(
        (1-t)^3*p1[1] + 3*t*(1-t)^2*p2[1] + 3*t^2*(1-t)*p3[1] + t^3*p4[1],
        (1-t)^3*p1[2] + 3*t*(1-t)^2*p2[2] + 3*t^2*(1-t)*p3[2] + t^3*p4[2]
    )
}

O <- function(l, t) {
    center <- l[[1]]; radius <- l[[2]]
    cbind(
        center[1] + radius*cos(2*pi*t),
        center[2] + radius*sin(2*pi*t)
    )
}

t <- seq(0, 1, by = 0.001)
s <- seq(-6, 6, by = 0.01)

dat <- rbind(
    Q(m[[1]][1:3, ], seq(0, 1, length = 2000+1)),
    O(list(c = c(0.9177, 1.3935), r = sqrt(8.98)), seq(0.836, 1.094, length = 1000+1) %% 1),
    C(m[[2]][10:7, ], t),
    O(clist[[1]], seq(0.189, 0.294, length = 1000+1)),
    Q(m[[2]][6:4, ], t),
    C(m[[2]][4:1, ], t),
    O(clist[[3]], seq(0.316, 0.769, length = 2000+1)),
    Q(m[[1]][6:4, ], t)
)

write.table(dat, file = "kucc.dat")

# read.table("kucc.dat")
